# Misskeyフォーク機能比較調査

各Misskeyフォーク（Sharkey、CherryPick、Misskey.io）の主要な機能改善をカテゴリ別にまとめた調査レポート。misskey-rsの機能計画の参考資料として活用する。

*調査日: 2025-12-11*

---

## サマリー

| フォーク | 特徴 | 主要な差別化ポイント |
|---------|------|---------------------|
| **Sharkey** | 最も機能豊富なフォーク | Mastodon互換API、投稿編集連合、高度なモデレーション |
| **CherryPick** | UI/UX改善に注力 | MFM装飾UI、集中モード、アイコンデコレーション詳細設定 |
| **Misskey.io** | 運用最適化・独自拡張 | 効果音カスタマイズ、本家へのcherry-pick貢献 |

---

## 1. 連合・ActivityPub関連

### Sharkey

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| 投稿編集の完全連合対応 | 編集履歴も閲覧可能、インタラクションした全員に配信 | ⚠️ 部分実装（編集API実装済、ActivityPub Update未対応） |
| Mastodon互換API（OAuth2含む） | 既存Mastodonクライアントからの利用可能 | ⚠️ 部分実装（60%: accounts, statuses, timelines） |
| いいね/リアクションの適切な連合 | Mastodon/Pleroma/Akkomaへ正しく送信 | 🔴 未実装 |
| 引用リノートのMastodon連合 | Mastodonフォークと正しく連合 | 🟡 未実装 |
| ユーザー単位Authorized Fetch | Secure Modeを個別に有効/無効化 | 🟡 未実装 |
| リモートユーザーのリンク検証表示 | リモートプロフィールでも検証結果を表示 | 🟢 未実装 |

### CherryPick

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| リモート絵文字即時インポート | ノート本文・リアクションビューアから即座にインポート | 🟢 未実装 |

---

## 2. データインポート・エクスポート

### Sharkey

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| マルチプラットフォームインポート | Mastodon、Pleroma/Akkoma、Misskey/Firefish、Twitter、Instagram、Facebook対応 | ⚠️ 部分実装（フォローCSV/JSONインポート対応） |
| GDPRスタイルデータエクスポート | ユーザーが自分に関連するすべてのデータをエクスポート可能 | ⚠️ 部分実装（プロフィール、フォロー/フォロワーエクスポート対応） |

---

## 3. タイムライン・フィード

### Sharkey

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| 「following」ビュー | Cohostの「following feed」にインスパイア | 🟢 未実装 |
| バブルタイムライン | 管理者設定のリモートインスタンスリストからの全ノート表示 | 🟡 未実装 |
| スレッドリアルタイム更新 | スレッドビューがリアルタイムで更新 | ✅ 実装済（WebSocket/SSEストリーミング） |
| ミュートインスタンスのフォロー例外 | ミュートインスタンスでもフォローユーザーは表示 | 🟢 未実装 |
| タイムラインフィルター | ブースト表示、ファイル付きノートのみ等 | ✅ 実装済（ワードフィルター、チャンネルTL） |
| Bot非表示オプション | Botをタイムラインから非表示 | 🟢 未実装 |

### CherryPick

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| InstanceTickerクリック | InstanceTickerをクリックしてノート詳細表示 | 🟢 未実装（フロントエンド） |

---

## 4. 投稿・ノート機能

### Sharkey

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| ブースト別公開範囲 | ブースト/リノートごとに公開範囲を指定 | 🟡 未実装 |
| ブースト回数制限 | 1ノートにつき1ユーザー1ブーストのみ | 🟢 未実装 |
| 予約投稿 | ノートを予約して投稿 | ✅ 実装済（schedule/create, update, list, delete） |
| デフォルトCW設定 | CWのデフォルト値を設定可能 | 🟢 未実装 |
| 親ノート折りたたみ | タイムラインで返信の「親」ノートを折りたたみ | 🟢 未実装（フロントエンド） |
| 全箇所翻訳対応 | 引用時や返信表示時など、どこでも翻訳可能 | ✅ 実装済（翻訳API対応） |

### CherryPick

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| テキスト装飾UI | MFM、HTML、Markdownをボタンから簡単に追加 | 🟢 未実装（フロントエンド） |
| リノート/引用ボタン表示選択 | 表示方法を選択可能 | 🟢 未実装（フロントエンド） |
| ノートクリックで詳細表示 | クリックオプション | 🟢 未実装（フロントエンド） |

---

## 5. MFM拡張

### Sharkey

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| 数式レンダリング | LaTeX等の数式表示 | 🟢 未実装（フロントエンド） |
| 双方向テキスト | RTL言語対応 | 🟢 未実装（フロントエンド） |
| 新MFM構文 | `$[crop]`、`$[fade]`、`$[followmouse]` | 🟢 未実装（フロントエンド） |
| インライン画像 | `![alt text](image url)`形式 | 🟢 未実装（フロントエンド） |
| 拡張ハッシュタグ | より多くの文字を受け入れる（`#æîç`等） | 🟢 未実装 |
| 検索ボックス改善 | 「search」終端のみで検索ボックス作成しない | 🟢 未実装（フロントエンド） |
| 検索エンジン選択 | MFM `[search]`の検索エンジン指定 | 🟢 未実装（フロントエンド） |
| MFMチートシート | ノート作成時の参照用 | 🟢 未実装（フロントエンド） |

---

## 6. メディア・ドライブ

### Sharkey

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| モジュール音楽再生 | トラッカー形式の音楽ファイル対応 | 🟢 未実装（フロントエンド） |
| Flash再生 | swfファイル対応 | 🟢 未実装（フロントエンド） |
| 動画ストリーミング最適化 | より速く再生開始 | ⚠️ 部分実装（HLS/DASHインターフェース設計済） |
| altテキスト欠落マーク | altなしメディアにマーク表示 | 🟡 未実装（フロントエンド） |
| 長いaltテキスト対応 | 文字数上限緩和 | 🟢 未実装 |
| altテキスト警告 | alt無し投稿時に警告オプション | 🟡 未実装（フロントエンド） |
| ドライブ検索 | ファイル・フォルダを名前/説明で検索 | 🟡 未実装 |
| 添付デフォルト折りたたみ | 添付ファイルをデフォルトで折りたたみ | 🟢 未実装（フロントエンド） |
| メディアダウンロードボタン | 音声・動画のダウンロードボタン | 🟢 未実装（フロントエンド） |

### CherryPick

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| 画像圧縮方式選択 | 圧縮アルゴリズムを選択可能 | ⚠️ 部分実装（WebP/AVIF設定設計済） |

---

## 7. プロフィール・ユーザー

### Sharkey

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| Listenbrainz統合 | 連合対応の音楽再生ステータス | 🟢 未実装 |
| プロフィール背景画像 | 連合対応 | 🟢 未実装 |
| アバターデコレーション背面配置 | 尻尾など後ろに配置可能 | 🟢 未実装（フロントエンド） |
| プロフィールタブ | ノート/すべて/ファイル付きタブ | ✅ 実装済（users/notes API） |
| ポップアッププロフィール拡張 | フォロー承認制表示、リモートプロフィール開く、カスタムフィールド | 🟢 未実装（フロントエンド） |
| インデックス化無効 | ノートのインデックス化を無効化（連合対応） | 🟡 未実装 |
| RSSフィード無効化 | ノートのRSSフィードを無効化 | 🟢 未実装 |
| `fediverse:creator`属性 | リンクプレビューに帰属ドメイン表示 | 🟢 未実装 |

### CherryPick

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| アイコンデコレーション詳細設定 | 位置、サイズ、不透明度を細かく調整 | 🟢 未実装（フロントエンド） |

---

## 8. UI/UX改善

### Sharkey

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| ノートクリックで詳細表示 | モバイルで便利なオプション | 🟢 未実装（フロントエンド） |
| 角丸/角型選択 | UI要素の形状を選択 | 🟢 未実装（フロントエンド） |
| サインアウトボタン | ユーザーメニューに追加 | ✅ 実装済（signout API） |
| 会話CW一括展開/折りたたみ | ボタンで全CWを制御 | 🟢 未実装（フロントエンド） |
| 長いノート全文表示 | 常に全文表示するオプション | 🟢 未実装（フロントエンド） |
| CW常時展開 | CW付きノートを常に展開 | 🟢 未実装（フロントエンド） |
| ワンボタンいいね | いいねとリアクションを分離 | 🟡 未実装 |
| MFMアニメーション制御 | 各ノートで有効/無効化 | 🟢 未実装（フロントエンド） |
| スレッド深さ変更 | 詳細ビューの深さを変更可能（デフォルト5） | 🟢 未実装（フロントエンド） |
| 戻るボタン | 各ページ上部に追加 | 🟢 未実装（フロントエンド） |
| テーマフォント指定 | テーマでフォントを指定 | 🟢 未実装（フロントエンド） |
| 可読CSSクラス名 | ブラウザカスタマイズ容易化 | 🟢 未実装（フロントエンド） |
| 接続切断警告無効化 | 警告を無効化可能 | 🟢 未実装（フロントエンド） |
| デフォルトリアクション設定 | いいね/リアクションのデフォルト絵文字 | 🟢 未実装 |

### CherryPick

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| 集中モード | 全通知を消音 | 🟢 未実装（フロントエンド） |
| リアクションツールチップ | 状態に応じてツールチップ変更 | 🟢 未実装（フロントエンド） |
| 編集時刻表示 | ヘッダーアイコンホバーで最終編集時刻 | ✅ 実装済（notes APIでupdated_at返却） |
| 翻訳完了振動 | 翻訳完了を振動で通知 | 🟢 未実装（フロントエンド） |

---

## 9. 検索・フィルタリング

### Sharkey

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| ファイル付きノート検索 | 検索結果をファイル付きに限定 | ✅ 実装済（has_media検索フィルタ） |
| 検索+lookup統合 | 完全修飾リモートユーザー名を検索 | ✅ 実装済（search/users API） |
| Meilisearch活用拡張 | より多くのケースで活用 | 🟡 未実装（PostgreSQL tsvectorは実装済） |
| 検索ウィジェット | ウィジェットとして追加可能 | 🟢 未実装（フロントエンド） |
| 大文字小文字無視の絵文字検索 | 検索の使いやすさ向上 | 🟢 未実装 |
| 絵文字検索マッチ順序 | 最も近いマッチを最初に表示 | 🟢 未実装 |

---

## 10. アンテナ

### Sharkey

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| インスタンス指定アンテナ | 特定インスタンスの全ユーザーを表示 | 🟡 未実装 |

### CherryPick

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| ユーザー除外 | アンテナで特定ユーザーを除外 | ✅ 実装済（アンテナ条件に除外キーワード対応） |

### misskey-rs独自

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| Aho-Corasick高速マッチング | 複数キーワードの高速並列検索 | ✅ 実装済 |
| mark-all-as-read | アンテナノート一括既読 | ✅ 実装済 |

---

## 11. モデレーション・管理者機能

### Sharkey

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| 登録承認必須 | 新規ユーザー登録に承認を必須化 | 🟡 未実装 |
| ユーザーサイレンス | サイレンス機能 | ✅ 実装済（user_suspension + is_silenced） |
| メディアNSFWマーク | ユーザー全メディアまたはインスタンス全体を強制NSFW | 🟡 未実装 |
| 引用機能削除 | 特定ユーザー/インスタンスの引用を無効化 | 🟢 未実装 |
| CW強制 | ユーザーにCWを強制 | 🟢 未実装 |
| Botトレンド除外 | Botをトレンドから除外 | 🟢 未実装 |
| リモート絵文字削除 | 削除可能 | ✅ 実装済（emojis API） |
| 実績機能無効化 | 無効化可能 | 🟢 未実装 |
| リモートユーザー強制更新 | 詳細情報を強制更新 | 🟢 未実装 |
| 文字数制限設定 | ローカル/リモート別に6つの設定 | 🔴 未実装 |
| 寄付URL設定 | インスタンス設定 | 🟢 未実装 |
| ユーザーファイル一括削除 | モデレーターが実行可能 | 🟢 未実装 |
| インスタンスファイル一括削除 | リモートインスタンスのファイルを削除 | 🟢 未実装 |
| レポート自動拒否 | 特定インスタンスからのレポートを自動拒否 | 🟢 未実装 |
| ブロックインスタンス非表示 | 非ログインユーザーに表示しない | 🟡 未実装 |

### misskey-rs独自

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| インスタンスブロック/サイレンス | 管理者APIで設定可能 | ✅ 実装済 |
| ブロック理由記録 | moderation_noteフィールド | ✅ 実装済 |
| インスタンス統計 | ユーザー数、ノート数等 | ✅ 実装済 |

---

## 12. プライバシー・セキュリティ

### Sharkey

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| 外部リンク確認ダイアログ | ドメインホワイトリスト設定可能 | 🟡 未実装（フロントエンド） |
| レート制限強化 | パスワードチェック/WebSocketにレート制限 | ✅ 実装済（API + フェデレーション両方） |
| argon2ハッシュ | bcryptの代わりにargon2を使用 | ✅ 実装済 |
| robots.txt設定 | 内容を管理者が設定可能 | 🟢 未実装 |

### misskey-rs独自

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| 2FA（TOTP） | バックアップコード対応 | ✅ 実装済 |
| WebAuthn/パスキー | FIDO2準拠、複数キー対応 | ✅ 実装済 |
| OAuth 2.0 | PKCE対応、スコープベース | ✅ 実装済 |
| リプレイ攻撃防止 | タイムスタンプ/重複チェック | ✅ 実装済 |
| インスタンス別レート制限 | フェデレーション保護 | ✅ 実装済 |

---

## 13. パフォーマンス・インフラ

### Sharkey

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| 小型コンテナイメージ | 未使用依存関係を除外 | ✅ Rust静的バイナリ（非常に小型） |
| URLプレビューキャッシュ | サーバーでキャッシュ | 🟡 未実装 |
| Redis UNIXソケット | ソケット経由接続 | 🟢 未実装 |
| PostgreSQL tsvector検索 | 全文検索エンジン | ✅ 実装済 |
| BunnyCDN対応 | S3互換サービスに加えて対応 | 🟢 未実装 |
| 環境変数設定上書き | `MK_CONFIG_DB_PASS`等で上書き | ✅ 実装済（MISSKEY_プレフィックス） |
| 複数設定ファイル | ワイルドカード対応 | ⚠️ 部分実装（環境別設定対応） |
| 翻訳サービス拡張 | DeepLX-JS、LibreTranslate対応 | ✅ 実装済（DeepL, Google, LibreTranslate, OpenAI, Claude, Ollama） |
| BSD対応 | ビルドと実行をサポート | 🟢 未検証 |
| ActivityPubログ出力 | 連合デバッグ用 | 🟢 未実装 |

### CherryPick

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| jemallocメモリアロケータ | パフォーマンス最適化 | ✅ Rust標準アロケータ（高効率） |
| データ節約モード | コードハイライトロード削減 | 🟢 未実装（フロントエンド） |

### misskey-rs独自

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| リモートアクターキャッシュ | 24時間TTL | ✅ 実装済 |
| 再帰CTEによるスレッド取得 | N+1問題解消 | ✅ 実装済 |
| カウンター直接更新 | アトミック操作 | ✅ 実装済 |
| SharedInbox最適化 | 配信効率化 | ✅ 実装済 |

---

## 14. Misskey.io独自機能

| 機能 | 説明 | 実装状況 |
|------|------|----------|
| 効果音カスタマイズ | 独自専用ボイスを選択可能 | 🟢 未実装（フロントエンド） |
| 本家へのcherry-pick | ElasticSearchサポート等 | (参考情報) |

---

## misskey-rsでの優先実装候補

### Tier 1: 最優先（残り実装必要）

| 機能 | カテゴリ | 状況 |
|------|---------|------|
| 投稿編集の連合対応 | 連合 | ⚠️ ActivityPub Update未対応 |
| Mastodon互換API完全対応 | 連合 | ⚠️ 60%実装（残りメディア等） |
| いいね/リアクションの適切な連合 | 連合 | 🔴 未実装 |
| ローカル/リモート別文字数制限 | 管理 | 🔴 未実装 |

### Tier 2: 中優先（残り実装必要）

| 機能 | カテゴリ | 状況 |
|------|---------|------|
| バブルタイムライン | タイムライン | 🟡 未実装 |
| ワンボタンいいね | UI/UX | 🟡 未実装 |
| ドライブ検索 | メディア | 🟡 未実装 |
| インスタンス指定アンテナ | アンテナ | 🟡 未実装 |
| 登録承認必須 | 管理 | 🟡 未実装 |
| URLプレビューキャッシュ | パフォーマンス | 🟡 未実装 |

### Tier 3: 低優先

| 機能 | カテゴリ | 状況 |
|------|---------|------|
| MFM拡張構文 | MFM | 🟢 未実装（フロントエンド） |
| プロフィール背景画像 | プロフィール | 🟢 未実装 |

---

## 実装済み機能一覧

### セキュリティ・認証
| 機能 | 備考 |
|------|------|
| ✅ argon2ハッシュ | bcryptの代替 |
| ✅ レート制限（API + フェデレーション） | 多層防御 |
| ✅ 2FA（TOTP） | バックアップコード対応 |
| ✅ WebAuthn/パスキー | FIDO2準拠 |
| ✅ OAuth 2.0 | PKCE対応 |
| ✅ リプレイ攻撃防止 | タイムスタンプ/重複チェック |
| ✅ インスタンス別レート制限 | フェデレーション保護 |

### パフォーマンス・インフラ
| 機能 | 備考 |
|------|------|
| ✅ PostgreSQL tsvector検索 | 日本語対応全文検索 |
| ✅ リモートアクターキャッシュ | 24時間TTL |
| ✅ 再帰CTEスレッド取得 | N+1問題解消 |
| ✅ カウンター直接更新 | アトミック操作 |
| ✅ SharedInbox最適化 | 配信効率化 |
| ✅ 環境変数設定上書き | MISSKEY_プレフィックス |
| ✅ 小型コンテナイメージ | Rust静的バイナリ |

### 機能
| 機能 | 備考 |
|------|------|
| ✅ 予約投稿 | CRUD + スケジューラー |
| ✅ ワードフィルター | アクション選択、期限付き、統計 |
| ✅ ノート編集 | 履歴保存（連合は未対応） |
| ✅ アンテナ | Aho-Corasick高速化、一括既読 |
| ✅ チャンネル | タイムライン、検索、フォロー |
| ✅ クリップ | 検索、順序変更 |
| ✅ グループ | オープン/招待制/承認制、ロール |
| ✅ ギャラリー | タグ、いいね |
| ✅ ページ | JSONコンテンツ、いいね |
| ✅ Webhook | HMAC署名、イベント対応 |
| ✅ プッシュ通知 | VAPID、静かな時間帯 |
| ✅ メール通知 | マルチプロバイダー、テンプレート |

### 検索・フィルタリング
| 機能 | 備考 |
|------|------|
| ✅ 高度な検索フィルタ | 日時範囲、リアクション数、メディア有無等 |
| ✅ ファイル付きノート検索 | has_mediaフィルタ |
| ✅ ユーザー検索（lookup統合） | リモートユーザー名対応 |
| ✅ 通知タイプフィルタ | include/excludeタイプ |
| ✅ タイムラインフィルター | ワードフィルター適用 |

### 翻訳
| 機能 | 備考 |
|------|------|
| ✅ DeepL | プロバイダー対応 |
| ✅ Google Translate | プロバイダー対応 |
| ✅ LibreTranslate | セルフホスト対応 |
| ✅ OpenAI API | LLM翻訳 |
| ✅ Anthropic Claude | LLM翻訳 |
| ✅ Ollama | ローカルLLM |

### モデレーション・管理
| 機能 | 備考 |
|------|------|
| ✅ インスタンスブロック/サイレンス | 管理API |
| ✅ ブロック理由記録 | moderation_note |
| ✅ インスタンス統計 | ユーザー数、ノート数 |
| ✅ ユーザーサイレンス | user_suspension |
| ✅ リモート絵文字削除 | emojis API |

### データ
| 機能 | 備考 |
|------|------|
| ✅ フォローインポート | CSV/JSON |
| ✅ プロフィールエクスポート | JSON |
| ✅ フォロー/フォロワーエクスポート | JSON |
| ✅ アカウント移行 | also_known_as/moved_to_uri |
| ✅ アカウント削除 | 猶予期間付きソフト削除 |

---

## 参照リンク

### Sharkey
- [Sharkey vs Misskey Comparison](https://docs.joinsharkey.org/docs/comparison/misskey/)
- [Sharkey GitHub](https://github.com/transfem-org/Sharkey)

### CherryPick
- [CherryPick Changelog](https://github.com/kokonect-link/cherrypick/blob/develop/CHANGELOG_CHERRYPICK.md)
- [CherryPick GitHub](https://github.com/kokonect-link/cherrypick)

### Misskey.io
- [MisskeyHQ Wiki - Misskey.io](https://wiki.misskey.io/ja/instances/misskey_io)
- [MisskeyIO GitHub](https://github.com/MisskeyIO/misskey)

---

## 更新履歴

| 日付 | 更新内容 |
|------|----------|
| 2025-12-11 | 初版作成 - Sharkey、CherryPick、Misskey.ioの機能調査 |
| 2025-12-11 | 実装状況を更新 - misskey-rs実装済み機能を反映、40+機能が実装済み |
